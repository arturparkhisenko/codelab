<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1.0, user-scalable=yes">
  <title>WebRTC codelab</title>
  <link rel="icon" href="img/favicon-flask.ico" type="image/x-icon">
  <script type="text/javascript" src="https://unpkg.com/default-passive-events"></script>
  <script src="../webcomponentsjs/webcomponents-lite.min.js" async></script>
  <script>
    window.Polymer = {
      dom: 'shadow',
      lazyRegister: 'max',
      useNativeCSSProperties: true
    };
  </script>
  <link rel="stylesheet"
        href="//fonts.googleapis.com/css?family=Roboto:300,400,400italic,500,500italic,700,700italic|Roboto+Mono:400,700">
  <link rel="import" href="../iron-icons/iron-icons.html">
  <link rel="import" href="../paper-button/paper-button.html">
  <link rel="import" href="../codelab-components/google-codelab-elements.html">

  <style is="custom-style"> 
    body {
      font-family: 'Roboto', 'Helvetica Neue', Helvetica, Arial;
      background: var(--google-codelab-background, --paper-grey-300);
    }
  </style>
</head>
<body>


  <google-codelab title="WebRTC Codelab Tutorial!"
                  feedback-link="https://github.com/misi/codelab"
                  environment="web"
                  last-updated="2018-01-31">

<!-- ================================ Step ========================================= -->
    <google-codelab-step label="Test" duration="5">
      <h2>Not used pics</h2>      
      
      <h2>Aside test</h2>
      <aside class="warning">
        <p>Warning</p>
      </aside>
      <aside class="tip">
        <p>Tip</p>
      </aside>
      <aside class="note">
        <p>Note</p>
      </aside>
      <aside class="callout">
        <p>CallOut</p>
      </aside>
      <aside class="special">
        <p>
          Download button test
        </p>
        <p>
          <paper-button raised class="colored">
            <iron-icon icon="file-download"></iron-icon>
            <a href="https://chrome.google.com/webstore/detail/chrome-dev-editor-develop/pnoffddplpippgcfjdhbmhkofpnaalpg?hl=en">Download Chrome Dev Editor</a>
          </paper-button>
        </p>
      </aside>
    </google-codelab-step>    
<!-- ================================ Step ========================================= -->
    <google-codelab-step label="Introduction" duration="5">
      <aside class="tip">
        <strong>Notice</strong>:&nbsp;
          <p>This codelab is strongls inspired by Google WebRTC CodeLab
            <a href="https://codelabs.developers.google.com">https://codelabs.developers.google.com</a>
          </p>
        <strong>Thanks for codelab framework!</strong>
          <p>
            <a href="https://github.com/googlecodelabs/codelab-components">https://github.com/googlecodelabs/codelab-components</a>
          </p>
      </aside>
      <h2>WebRTC Definitions and it's Mission:</h2>
      <ul>
        <li>WebRTC: “A framework, protocols and application programming interface that provide real time interactive voice, video and data in web browsers and other applications”</li>
        <li>WebRTC is a free, open project that provides browsers and mobile applications with Real-Time Communications (RTC) capabilities via simple APIs. The WebRTC components have been optimized to best serve this purpose.</li>
        <li>Mission: To enable rich, high-quality RTC applications to be developed for the browser, mobile platforms, and IoT devices, and allow them all to communicate via a common set of protocols.</li>
      </ul>
      <p>Project Web<a href="https://webrtc.org">https://webrtc.org</a></p>
      <h2>WebRTC Project Logo:</h2>
      <p>
        <img style="max-width: 100.00px" src="img/webrtc-logo-vert-retro-dist.svg">
        <!-- https://webrtc.org/assets/images/webrtc-logo-vert-retro-dist.svg -->
      </p>
      <p>
      <a href="https://webrtc.org/press/">https://webrtc.org/press/</a>
      </p>
      <h2>Goals</h2> 
      <ul>
        <li>Without Plugins</li>
        <li>Without Install</li>
        <li>Multi platform</li>
        <li>Always up2date</li>
        <li>P2P</li>
        <ul>
          <li>Low Delay / Latency / Jitter</li>
          <li>Advanced congestion avoidence</li>
          <li>Adaptive Audio Video encoding</li>
        </ul>
        <li>Firewal Traversal ICE(STUN/TURN)</li>        
        <li>Focus on Security and Privacy and Idenity by design</li>
        <li>Native Implementation</li>
        <li>Ultimate freedom in Signaling Level</li>
        <li>WebRTC 1.0 backward compatibility (e.g. SDP and audio codec)</li>
        <li>Encrypted Secure End to End communication</li>
      </ul>
      <h2>Base components:</h2>
      <ul>
        <li>GetUserMedia (GuM): Grab MediaStream from a Mediadevice</li>
        <li>PeerConnection (PC): Establish and Maintain Peer to Peer Connection</li>
      </ul>
    </google-codelab-step>
<!-- ================================ Step ========================================= -->
    <google-codelab-step label="Standardization" duration="5">
      <h2>WebRTC 1.0</h2>
      <ul>
        <li></li>
      </ul>
      <h2>WebRTC NV</h2>
      <ul>
        <li>QUIC transport for DataChannel/(Media?)</li>
        <li>More ORTC like deep API</li>
        <ul>
          <li>No more SDP</li>  
        </ul>        
        <li>More control on ICE Agent</li>
        <li>SVC</li>
      </ul>
      <h1>Codecs</h1>
      <h2>Mandator to Implement Audio codec</h2>
      <ul>
        <li>G711</li>
        <li>Opus</li>
      </ul>
      <h2>Manadatory to Implement Video codecs</h2>    
      It took a long to build consensus in the IETF RTCWEB workgroup (Codec war)
      <ul>
        <li>VP8 vs H.264</li>
        <li>(VP9 vs H.265)</li>
      </ul>
      <h2>Alliance for Open Media</h2>
      <ul>
        <li>AOMedia Video 1 (AV1) development</li>
        <li>Amazon, Cisco, Google, Intel, Microsoft, Mozilla, Netflix, etc.</li>
      </ul>      

    </google-codelab-step>

<!-- ================================ Step ========================================= -->
    <google-codelab-step label="History" duration="5">
      <h2>The begining</h2>
      <ul>
        <li><strong>2009</strong> - Google Chrome Team Idea</li>
        <li><strong>2010 Summer</strong> - IETF 98 Informal lunch (Google, Microsoft, Apple, Mozilla, Skype, Ericsson,etc.) </li>
        <li><strong>2010 October</strong> - RTC Web Workshop <a href="http://rtc-web.alvestrand.com/">http://rtc-web.alvestrand.com/</a></li>
        <li><strong>2011 January</strong> - Google Global IP Solution (GIPS) acquired.</li>        
        <li><strong>2011 May</strong> - W3C WebRTC WG statarted officialy</li>
        <li><strong>2011 June</strong> - Googe Anounce WebRTC project(based on GIPS) and chrome integration</li>
        <li><strong>2011 Nov</strong> - Chrome 23 WebRTC support</li>        
      </ul>
      <h2>Early birds</h2>
      <ul>
        <li><strong>2013 January</strong> - Firefox 20 first WebRTC support (only GuM)</li>
        <li><strong>2013 February</strong> - Chrome Mozilla first call interoperability</li>
        <li><strong>2013 July</strong> - Chrome for Android support</li>
        <li><strong>2013 September</strong> - Firefox for Android support</li>
        <li><strong>2013 October</strong> - Open H.264 Cisco (Mozilla)</li>
        <li><strong>2013 October </strong> - Opera 18 Beta WebRTC debut.</li>
        <li></li>
      </ul>
      <h2>Onbording on webRTC train</h2>
      <ul>
        <li><strong>2014 September</strong> - OpenWebRTC (Ericsson)</li>
        <li><strong>2014 October</strong> - Microsoft Edge ORTC Announcement</li>
        <li><strong>2014 November</strong> - Consensus on Mandatory to Implement Video Condecs :-)</li>
        <li><strong>2015 September</strong> - Microsoft Edge ORTC/WebRTC support</li>
        <li><strong>2015 November</strong> - Mozilla Canvas CaptureStream</li>
        <li><strong>2016 January</strong> - VP9 Chrome</li>
        <li><strong>2016 April</strong> - ICE Restart Firefox 48</li>
      </ul>
      <h2>Nowadays</h2>
      <ul>
        <li><strong>2017 June</strong> - Safari 11 WebRTC Support</li>
        <li><strong>2017 October</strong> - KITE WebRTC platform test</li>
        <li><strong>2017 October</strong> - Third Party Audio Codec Support</li>
        <li><strong>2017 November</strong> - WebRTC PeerConnection CR (W3C)</li>
      </ul>  
    </google-codelab-step>
<!-- ================================ Step ========================================= -->
    <google-codelab-step label="Mind the Gap!" duration="5">
      <p>
        <img src="img/mind-the-gap-hole-in-ground-by-frits-ahlefeldt.jpg" alt="mind-the-gap-hole-in-ground" />
      </p>
      <p>
        Source: <a href="http://art.fritsahlefeldt.com/photo/2414/Mind-the-gap-with-text-Color-illustration.html">http://art.fritsahlefeldt.com/photo/2414/Mind-the-gap-with-text-Color-illustration.html</a>
      </p>
      <h1>Adapter.js</h1>
      Standardization is a moving target. 
      Mind the gap between:
      <ul>
        <li>Standard and Browser Implementations</li>
        <li>Between bowser implementations</li>
        <li>Application and Standard</li>
      </ul>
      The adapter.js is a shim to insulate apps from spec changes and prefix differences.
      <ul>
        <li><a href="https://github.com/webrtc/adapter">https://github.com/webrtc/adapter</a></li>
        <li><a href="https://webrtc.org/web-apis/interop">https://webrtc.org/web-apis/interop/</a></li>        
      </ul>
      <h1>Breaking Changes</h1>
      <ul>
        <li>Firefox adds deprecation warning</li>
        <li>Carefully age out, pull down not  too soon.</li>
      </ul>
      <h2>Changes</h2>
      <ul>
        <li>Async API </li>
        <ul>
          <li>Move from callbacks, forward to Promises</li>  
        </ul>        
      </ul>
      <ul>
        <li>Media Capture Changes</li>
        <li>MediaDevice selection, detection on changes (discovery)</li>
        <ul>
          <li><span style="text-decoration: line-through">navigator.getUserMedia</span> is deprected</li>
          <ul class="checklist">
            <li>navigator.mediaDevices.getUserMedia</li>
          </ul>
        </ul>
        <ul>
          <li><span style="text-decoration: line-through">video.createObjectURL</span> is deprecated</li>
          <ul class="checklist">
            <li>video.srcObject</li>
          </ul>
        </ul>
      </ul>
      <h2>Constraint changed</h2>
      <pre><code>
{width: {min:1024, ideal: 1280, max: 1920}}</code></pre>
      <pre style="text-decoration: line-through"><code>
{
  mandatory: {width: {min: 640, max:1920}}, 
  optional [{width: 1280}]
}</code></pre>
      <ul>
        <li>Chrome constraints deprecated</li>
        <li>“optional” has new name “advanced”  </li>
      </ul>
      <h2>Stats</h2>
      <strong>New modern Stats (promise)</strong>
      <pre><code>
pc.getStats().then(stats =>stats.forEach(value=>...)</code></pre>
      <strong>Legacy Stats</strong>
      <pre style="text-decoration: line-through"><code>
pc.getStats(function(stats){
      Object.keys(stats).forEach(key =>...)
   }
)</code></pre>
      <h2>Strems => Tracks</h2>
      Manipulating (replacing tracks) after added a stream to peerconnection makes confusion, so add tracks instead of streams to peerconnection.
      <ul>
        <li>addStream is deprecated
          <ul>
            <li style="text-decoration: line-through">pc.addStream(stream)</li>
            <ul class="checklist">
              <li>stream.forEach(track => pc.addTrack(track,stream))</li>
            </ul>
          </ul>
        </li>
        <li>getLocalStreams is deprecated
          <ul>
            <li style="text-decoration: line-through">var streams = pc.getLocalStreams();</li>
            <ul class="checklist">
              <li>var senders = pc.getSenders();</li>
            </ul>
          </ul>
        </li>
        
      </ul>
    </google-codelab-step>
<!-- ================================ Step ========================================= -->
    <google-codelab-step label="WebRTC Architecture" duration="5">
      <h2>Protocol Stack Architecture</h2>
      <p><img src="img/Media-exchange-for-WebRTC.svg" alt="Media-exchange-for-WebRTC" />Media-exchange-for-WebRTC.svg</p>
      <h2>Architecture</h2>
      <p><img style="max-width: 749.00px" src="img/webrtc-public-diagram-for-website.png"></p>
      <!-- https://webrtc.org/assets/images/webrtc-public-diagram-for-website.png -->
      <a href="https://webrtc.org/architecture/">https://webrtc.org/architecture/</a>
      <h1>WebRTC Trapezoid</h1>
      <h2>Direct Peer to Peer Connection</h2>
      <p><img style="max-width: 749.00px" src="img/webrtc_architecture.png"></p>
      <aside class="note">
        <strong>Note</strong>:
	      <p>Direct Browser to Browser connection is prefered by default to keep the end to end delay low. This preferes TURN in last resort.</p>
        <p>Of course there are other reasonable prefereces, like safe connection or short connection establismnet time, that may prefer TURN first.</p> 
      </aside>
      <h2>Fallback to TURN relay</h2>
      <p><img style="max-width: 749.00px" src="img/webrtc_architecture2.png"></p>
      <p></p>
     </google-codelab-step>
<!-- ================================ Step ========================================= -->
   <google-codelab-step label="Congestion Avoidence" duration="5">
     <h2>REMB</h2>
     <h2>Sender Side Bandwidth Estimaion</h2>
     <h2>Forward Error Correction FEC</h2>
     <p>
       <ul>
         <li><a href="http://www.rtcbits.com/2017/01/bandwidth-estimation-in-webrtc-and-new.html">http://www.rtcbits.com/2017/01/bandwidth-estimation-in-webrtc-and-new.html</a></li>
         <li><a href="https://blog.mozilla.org/webrtc/what-is-rmcat-congestion-control/">https://blog.mozilla.org/webrtc/what-is-rmcat-congestion-control/</a></li>
       </ul>       
     </p>
     
     
    </google-codelab-step>

<!-- ================================ Step ========================================= -->
      <google-codelab-step label="NAT/Firewall traversal &amp; ICE (STUN/TURN)" duration="5">
        <img style="max-width: 500" src="img/graffiti-berlin-wall-wall-trabi.jpg" alt="wall-trabi">
        <h2>tl;dr</h2>
        <ul>        
          <li>multiplex in one connection (rtcp,audio/video)</li>
          <li>STUN is about to: Discover global IP:port</li>
          <li>STUN is a binary protocol</li>        
          <li>TURN is a STUN protocol extension</li>
          <li>TURN is about Allocate a global IP:port and relay</li>            
        </ul>
        <h2>Multiplexing</h2>
        <ul>
          <li>RTP RTCP multiplexing</li>
          <li>RTP multiplexing (audio video)</li>
        </ul>
        <aside class="tip">
          <strong>Tip!</strong>
          <p>Nice ICE Tutorials:</p>
          <ul>
            <li><a href="https://sdstrowes.co.uk/talks/20081031-ice-turn-stun-tutorial.pdf">https://sdstrowes.co.uk/talks/20081031-ice-turn-stun-tutorial.pdf</a></li>
            <li><a href="http://www.jdrosen.net/uploads/1/5/0/0/15008848/ice-ietf-tutorial2.pptx">http://www.jdrosen.net/uploads/1/5/0/0/15008848/ice-ietf-tutorial2.pptx</a></li>
          </ul>        
        </aside>
        <h2>STUN Bind</h2>
        <p><img src="img/stun_bind.png" alt="STUN Bind" /></p>
        <h2>TURN Bind</h2>
        <p><img src="img/turn_allocation.png" alt="TURN Allocation" /></p>
        <h2>Design Goals</h2>
        <ul>
          <li>High reliabalatiy is essential</li>
          <li>Minimize the "length" of the path between clients</li>
          <li>Negotiate IP protocol version (IPv4/IPV6) and preference</li>
          <li>No assumptation on:</li>
            <ul>
              <li>network topologies</li>
              <li>NAT or Firewall presence</li>
              <li>NAT behaviours</li>
            </ul>
        </ul>
        <h2>ICE Steps</h2>
        <ul>
          <li>Discovery and Candidate gathering</li>
          <ul>
            <li>Allocation</li>  
          </ul>
          <li>Prioritisation</li>
          <li>Exchange</li>
          <li>Connectivity Check</li>
            <ul>
              <li>Frozen Algorithm</li>
            </ul>
          <li>Coordination</li>
          <li>Communication</li>
        </ul>
        <h2>ICE Agent States</h2>
        <p><img style="max-width: 749.00px" src="https://www.w3.org/TR/webrtc/images/icetransportstate.svg"></p>
        <h2>Trickle ICE</h2>
        <p><img src="img/trickle_ice.png" alt="Trickle ICE" /></p>
        <h1>NAT Behavior Discovery (RFC5780)</h1>
        <h2>RFC 3489 definitions:</h2>
        <ul>
          <li>Full Cone</li>
          <li>Restricted Cone</li>
          <li>Port Restricted Cone</li>
          <li>Symmetric</li>        
        </ul>
        <h2>RFC 4787 and RFC 5780 base class definitions:</h2>
        <ul>
          <li>Mapping
            <ul>
              <li>Endpoint Independent Mapping</li>
              <li>Address-Dependent Mapping</li>
              <li>Address and Port-Dependent Mapping</li>            
            </ul>
          </li>
          <li>Filtering
            <ul>
              <li>Endpoint Independent Filtering</li>
              <li>Address-Dependent Filtering</li>
              <li>Address and Port-Dependent Filtering</li>            
            </ul>
          </li>
        </ul>        
        <p><img src="img/nat_behavior_discovery.png" alt="NAT Behavior Discovery" /></p>
        <aside class="tip">
          <strong>tip</strong>
          <ul>
            <li><a href="https://www.netmanias.com/ko/?m=view&id=blog&no=6263">https://www.netmanias.com/ko/?m=view&id=blog&no=6263</a></li>
            <li><a href="https://www.netmanias.com/en/?m=view&id=techdocs&no=6065">https://www.netmanias.com/en/?m=view&id=techdocs&no=6065</a></li>
            <li><a href="https://www.netmanias.com/en/post/techdocs/6067/nat-network-protocol/nat-behavior-discovery-using-stun-rfc-5780">https://www.netmanias.com/en/post/techdocs/6067/nat-network-protocol/nat-behavior-discovery-using-stun-rfc-5780</a></li>
          </ul>
          
        </aside>
      </google-codelab-step>
<!-- ================================ Step ========================================= -->
    <google-codelab-step label="SDP" duration="5">
      <aside class="tip">
        <h2>Tip: See SDP Anatomy on webrtcH4cKS</h2>
        <p>
          <a href="https://webrtchacks.com/sdp-anatomy">https://webrtchacks.com/sdp-anatomy</a>        
        </p>
      </aside>
      <h2>Plans</h2>
      <ul>
        <li><strong>Unified Plan</strong>:&nbsp;
          <ul>
            <li><a href="https://webrtcglossary.com/unified-plan">https://webrtcglossary.com/unified-plan</a></li>
            <li><a href="https://tools.ietf.org/html/draft-roach-mmusic-unified-plan-00">https://tools.ietf.org/html/draft-roach-mmusic-unified-plan-00</a></li>
          </ul>
        </li>
        <li><span style="text-decoration: line-through">Plan B</span>: (Obsoleted)
          <ul>
            <li><a href="https://webrtcglossary.com/unified-plan">https://webrtcglossary.com/unified-plan</a></li>
            <li><a href="https://tools.ietf.org/html/draft-uberti-rtcweb-plan-00">https://tools.ietf.org/html/draft-uberti-rtcweb-plan-00</a></li>
            <li>Chrome / Chromium is still working the transition to Unified Plan<a href="https://bugs.chromium.org/p/chromium/issues/detail?id=465349">https://bugs.chromium.org/p/chromium/issues/detail?id=465349</a></li>
          </ul>
        </li>
      </ul>
      <aside class="tip">
        <strong>Adapter:</strong>
        <p>
          <span>It is very hard to polyfill plan differences.</span>
          <span>An example: <a href="https://www.npmjs.com/package/sdp-interop">https://www.npmjs.com/package/sdp-interop</a></span>
        </p>
      </aside>
      <h1>Example SDP</h1>
      <h2>Offer</h2>
      <pre><code>
v=0
o=mozilla...THIS_IS_SDPARTA-58.0.2 1392930692610468855 0 IN IP4 0.0.0.0
s=-
t=0 0
a=sendrecv
a=fingerprint:sha-256 97:73:D6:F9:B8:4C:4A:29:3B:E0:B4:3E:E6:37:F6:D0:B7:8A:88:D9:E5:D2:C4:F8:74:66:18:B7:84:18:BB:42
a=group:BUNDLE sdparta_0 sdparta_1
a=ice-options:trickle
a=msid-semantic:WMS *
m=audio 51644 UDP/TLS/RTP/SAVPF 109 9 0 8 101
c=IN IP4 193.224.69.74
a=candidate:0 1 UDP 2122252543 192.0.2.1 53693 typ host
a=candidate:4 1 TCP 2105524479 192.0.2.1 9 typ host tcptype active
a=candidate:0 2 UDP 2122252542 192.0.2.1 40157 typ host
a=candidate:4 2 TCP 2105524478 192.0.2.1 9 typ host tcptype active
a=candidate:3 1 UDP 92217087 193.224.69.74 51644 typ relay raddr 193.224.69.74 rport 51644
a=candidate:3 2 UDP 92217086 193.224.69.74 64126 typ relay raddr 193.224.69.74 rport 64126
a=sendrecv
a=end-of-candidates
a=extmap:1/sendonly urn:ietf:params:rtp-hdrext:ssrc-audio-level
a=extmap:2 urn:ietf:params:rtp-hdrext:sdes:mid
a=fmtp:109 maxplaybackrate=48000;stereo=1;useinbandfec=1
a=fmtp:101 0-15
a=ice-pwd:957d8d9d754992a1d5a7706d5cb2e1fe
a=ice-ufrag:732f8881
a=mid:sdparta_0
a=msid:{69779578-0a01-46d5-afb8-c1ce8eb8b4f7} {3b93eb2f-9bf4-4955-95d0-5379eeba3e11}
a=rtcp:64126 IN IP4 193.224.69.74
a=rtcp-mux
a=rtpmap:109 opus/48000/2
a=rtpmap:9 G722/8000/1
a=rtpmap:0 PCMU/8000
a=rtpmap:8 PCMA/8000
a=rtpmap:101 telephone-event/8000
a=setup:actpass
a=ssrc:2764815782 cname:{08b8c6e5-8963-4a02-825f-d55ddb7076ba}
m=video 51644 UDP/TLS/RTP/SAVPF 120 121 126 97
c=IN IP4 193.224.69.74
a=candidate:0 1 UDP 2122252543 192.0.2.1 55556 typ host
a=candidate:4 1 TCP 2105524479 192.0.2.1 9 typ host tcptype active
a=candidate:0 2 UDP 2122252542 192.0.2.1 42946 typ host
a=candidate:4 2 TCP 2105524478 192.0.2.1 9 typ host tcptype active
a=candidate:3 1 UDP 92217087 193.224.69.74 52200 typ relay raddr 193.224.69.74 rport 52200
a=candidate:3 2 UDP 92217086 193.224.69.74 65354 typ relay raddr 193.224.69.74 rport 65354
a=sendrecv
a=extmap:1 http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time
a=extmap:2 urn:ietf:params:rtp-hdrext:toffset
a=extmap:3 urn:ietf:params:rtp-hdrext:sdes:mid
a=fmtp:126 profile-level-id=42e01f;level-asymmetry-allowed=1;packetization-mode=1
a=fmtp:97 profile-level-id=42e01f;level-asymmetry-allowed=1
a=fmtp:120 max-fs=12288;max-fr=60
a=fmtp:121 max-fs=12288;max-fr=60
a=ice-pwd:957d8d9d754992a1d5a7706d5cb2e1fe
a=ice-ufrag:732f8881
a=mid:sdparta_1
a=msid:{69779578-0a01-46d5-afb8-c1ce8eb8b4f7} {c4e521ab-ac5c-468d-bda4-102fa8c63ad1}
a=rtcp:65354 IN IP4 193.224.69.74
a=rtcp-fb:120 nack
a=rtcp-fb:120 nack pli
a=rtcp-fb:120 ccm fir
a=rtcp-fb:120 goog-remb
a=rtcp-fb:121 nack
a=rtcp-fb:121 nack pli
a=rtcp-fb:121 ccm fir
a=rtcp-fb:121 goog-remb
a=rtcp-fb:126 nack
a=rtcp-fb:126 nack pli
a=rtcp-fb:126 ccm fir
a=rtcp-fb:126 goog-remb
a=rtcp-fb:97 nack
a=rtcp-fb:97 nack pli
a=rtcp-fb:97 ccm fir
a=rtcp-fb:97 goog-remb
a=rtcp-mux
a=rtpmap:120 VP8/90000
a=rtpmap:121 VP9/90000
a=rtpmap:126 H264/90000
a=rtpmap:97 H264/90000
a=setup:actpass
a=ssrc:1307424569 cname:{08b8c6e5-8963-4a02-825f-d55ddb7076ba}
      </code></pre>
      <h2>Answer</h2>
      <pre><code>
v=0
o=mozilla...THIS_IS_SDPARTA-58.0.2 8465178051030770266 0 IN IP4 0.0.0.0
s=-
t=0 0
a=sendrecv
a=fingerprint:sha-256 F7:8B:D4:93:EC:66:10:17:A7:88:E2:DB:E2:02:D8:A8:0E:78:0C:47:D1:CF:AC:A8:4A:7F:B0:F8:9C:22:54:DD
a=group:BUNDLE sdparta_0 sdparta_1
a=ice-options:trickle
a=msid-semantic:WMS *
m=audio 9 UDP/TLS/RTP/SAVPF 109 101
c=IN IP4 0.0.0.0
a=candidate:0 1 UDP 2122252543 198.51.100.65 39578 typ host
a=candidate:4 1 UDP 2122187007 198.51.100.177 34202 typ host
a=candidate:8 1 TCP 2105524479 198.51.100.65 9 typ host tcptype active
a=candidate:9 1 TCP 2105458943 198.51.100.177 9 typ host tcptype active
a=candidate:3 1 UDP 92217087 193.224.69.74 55675 typ relay raddr 193.224.69.74 rport 55675
a=sendrecv
a=extmap:2 urn:ietf:params:rtp-hdrext:sdes:mid
a=fmtp:109 maxplaybackrate=48000;stereo=1;useinbandfec=1
a=fmtp:101 0-15
a=ice-pwd:36acccb528a6c8502e42656cc6c7b8cd
a=ice-ufrag:14888916
a=mid:sdparta_0
a=msid:{9cc1f70c-c78b-44b4-86fa-fcd82c530b1e} {4662f9ed-4a45-4f9f-964d-4ffff5535e5f}
a=rtcp-mux
a=rtpmap:109 opus/48000/2
a=rtpmap:101 telephone-event/8000
a=setup:active
a=ssrc:1899896363 cname:{0cc05c74-02a9-4474-9885-9ea7674b8299}
m=video 9 UDP/TLS/RTP/SAVPF 120
c=IN IP4 0.0.0.0
a=sendrecv
a=extmap:1 http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time
a=extmap:2 urn:ietf:params:rtp-hdrext:toffset
a=extmap:3 urn:ietf:params:rtp-hdrext:sdes:mid
a=fmtp:120 max-fs=12288;max-fr=60
a=ice-pwd:36acccb528a6c8502e42656cc6c7b8cd
a=ice-ufrag:14888916
a=mid:sdparta_1
a=msid:{9cc1f70c-c78b-44b4-86fa-fcd82c530b1e} {425480c1-460a-4b92-8b43-59cc59062d0d}
a=rtcp-fb:120 nack
a=rtcp-fb:120 nack pli
a=rtcp-fb:120 ccm fir
a=rtcp-fb:120 goog-remb
a=rtcp-mux
a=rtpmap:120 VP8/90000
a=setup:active
a=ssrc:377924797 cname:{0cc05c74-02a9-4474-9885-9ea7674b8299}      
      </code></pre>
    </google-codelab-step>
<!-- ================================ Step ========================================= -->
     <google-codelab-step label="Offer Answer" duration="5">
       <h2>WebRTC Offer/Answer Model</h2>
       <p><img style="max-width: 800.00px" src="img/offer_answer_webrtc2.png"></p>
       <h2>PeerConnection States</h2>
       <p><img style="max-width: 749.00px" src="https://www.w3.org/TR/webrtc/images/peerstates.svg"></p>
     </google-codelab-step>
<!-- ================================ Step ========================================= -->
    <google-codelab-step label="WebRTC Security Architecture" duration="5">
      <h2>GetUserMedia</h2>
      <ul>
        <li>Secure User Interface opt-in (e.g. Camera, audio access)</li>
        <li>User can allow/deny audio video source usage</li>
      </ul>    
      <p>
        See EKR IETF presentation for detaied information: 
        <a href="http://www.ietf.org/proceedings/82/slides/rtcweb-13.pdf">http://www.ietf.org/proceedings/82/slides/rtcweb-13.pdf</a>
      </p>
      <h2>Offer Ansewer with Identity Check</h2>
      <p>
        <img src="img/cat-dog-computer-chat.jpg" alt="cat-and-dog-online">
        Source: <a href="https://hikingartist.com/2012/01/03/cat-and-dog-online-2-0/">https://hikingartist.com/2012/01/03/cat-and-dog-online-2-0/</a>
      </p>
      <p>The browser is the trust base. </p>
      <pre>
             +----------------+    Unspecified    +----------------+
             |                |      protocol     |                |
             |    Signaling   |<----------------->|    Signaling   |
             |    Server      |  (SIP, XMPP, ...) |    Server      |
             |                |                   |                |
             +----------------+                   +----------------+
                      ^                                   ^
                      |                                   |
                HTTPS |                                   | HTTPS
                      |                                   |
                      |                                   |
                      v                                   v
                   JS API                               JS API
             +-----------+                             +-----------+
             |           |             Media           |           |
       Alice |  Browser  |<--------------------------->|  Browser  | Bob
             |           |           DTLS+SRTP         |           |
             +-----------+                             +-----------+
                   ^      ^--+                      +--^     ^
                   |         |                      |        |
                   v         |                      |        v
             +-----------+   |                      |  +-----------+
             |           |<-------------------------+  |           |
             |   IdP1    |   |                         |    IdP2   |
             |           |   +------------------------>|           |
             +-----------+                             +-----------+
                   A federated call with IdP-based identity    
      </pre>
      <img src="img/offer_answer_identity.png" alt="offer_answer_identity">
      <img src="img/offer_answer_identity2.png" alt="offer_answer_identity2">      
      <h2>Media/Data Encryption is mandatory: SRTP / DTLS</h2>
      <ul>
          <li>DTLS-SRTP: DTLS and Certificate based key .</li>          
          <li><span style="text-decoration:line-through">SDES-SRTP</span><strong> "MUST NOT implement" according IETF 87</strong>
            <aside class="warning">
              <strong>Important</strong>:&nbsp;
              SDES-SRTP is obsolated to avoid any survilance possibility. This was a design decision, and it could add interop issues with legacy systems!!</strong>
          </aside>
          <aside class="tip"><strong>Identity is a must! </strong>                    
              We don't trust fully anymore in the signaling provider. Earlier, 
              in SDES-SRTP case we have trusted in signaling service provider, 
              that it authenticates the parties in the communication in some form.
              <strong>
               Be aware that WebRTC designed to use E2E encryption, 
               and without Identity validation security is not complete and leaky(!)
               This way it is extremly important to validate the Peers Identity.
              </strong>
            </aside>
          
          </li>
      </ul>
    </google-codelab-step>
<!-- ================================ Step ========================================= -->
    <google-codelab-step label="Multipoint (SFU/MCU, Media Server)" duration="5">
      <h2>Some examples from open source space:</h2>
      <ul>
        <li><a href="https://mediasoup.org">https://mediasoup.org</a></li>
        <li><a href="https://www.kurento.org">https://www.kurento.org</a></li>
        <li><a href="https://janus.conf.meetecho.com">https://janus.conf.meetecho.com</a></li>
        <li><a href="https://jitsi.org">https://jitsi.org</a></li>
        
      </ul>
    </google-codelab-step>
<!-- ================================ Step ========================================= -->
    <google-codelab-step label="Screensharing" duration="5">
      <p>Chrome extension: </p>
      <p>inline install:<p/>
     <ul>
       <li>
         <a href="https://developer.chrome.com/webstore/inline_installation" target="_blank">https://developer.chrome.com/webstore/inline_installation</a>
       </li>
     </ul>
     <p>Standard</p>
     <ul>
        <li>
         <a href="https://www.w3.org/TR/screen-capture/" target="_blank">https://www.w3.org/TR/screen-capture/</a>
       </li>
     </ul>
     <p>Mozilla</p>
     <ul>
       <li>
         <a href="https://blog.mozilla.org/webrtc/share-browser-windows-entire-screen-sites-trust/" /target="_blank">https://blog.mozilla.org/webrtc/share-browser-windows-entire-screen-sites-trust/</a>
       </li>
       <li>
         <a href="https://wiki.mozilla.org/Screensharing" /target="_blank">https://wiki.mozilla.org/Screensharing</a>
       </li>
      </ul>
      <pre><code>        mediaConstraints = {
          video: {
              mediaSource: &quot;screen&quot;
          },
        };</code></pre>
    </google-codelab-step>
<!-- ================================ Step ========================================= -->
    <google-codelab-step label="Summary of the Theory" duration="5">      
      <p>
       <img style="max-width: 750.00px" src="img/goal-is-closed-than-you-think-people-no-txt-illustration-by-frits-ahlefeldt.jpg" alt="goal-is-closed-than-you-think">
      </p>
      <p>
       Source: <a href="http://art.fritsahlefeldt.com/photo/2045/Goal-is-closer-than-you-think-Color-illustration.html">http://art.fritsahlefeldt.com/photo/2045/Goal-is-closer-than-you-think-Color-illustration.html</a>
      </p>
      <h2>WebRTC 1.0 is stable to build service on it.</h2>
      <ul>
        <li>Strong and wide community</li>
        <li>Fast New market</li>
        <li>3,5-4 Billion of potential Browser</li>
        <li>more then 1300+ Vendor and Project based on WebRTC</li>
        <li>Wide support in browsers: Chrome,Firefox, Opera, Edge, Safari, etc.</li>
      </ul>
      
    </google-codelab-step>
<!-- ================================ Step ========================================= -->
    <google-codelab-step label="Lab 1: GetuserMedia (GuM)" duration="5">
    </google-codelab-step>
<!-- ================================ Step ========================================= -->
    <google-codelab-step label="Lab 2: GuM Constraints" duration="5">
    </google-codelab-step>
<!-- ================================ Step ========================================= -->
    <google-codelab-step label="Lab 3: GuM I/O Select" duration="5">
    </google-codelab-step>
<!-- ================================ Step ========================================= -->
    <google-codelab-step label="Lab 4: GuM Record" duration="5">
    </google-codelab-step>
<!-- ================================ Step ========================================= -->
    <google-codelab-step label="Lab 5: GuM + PC state" duration="5">
    </google-codelab-step>
<!-- ================================ Step ========================================= -->
    <google-codelab-step label="Lab 6: PC DataChannel Chat" duration="5">
    </google-codelab-step>
<!-- ================================ Step ========================================= -->
    <google-codelab-step label="Lab 7: Nodejs Signaling Server (socket.io) Chat" duration="5">
    </google-codelab-step>
<!-- ================================ Step ========================================= -->
    <google-codelab-step label="Lab 8: Install KnockPlop" duration="5">
      <p>
        <pre>
          <code>
          
          </code>
        </pre>
      </p>    
    </google-codelab-step>
<!-- ================================ Step ========================================= -->
     <google-codelab-step label="Congratulations" duration="5">
      <h2>What you learned</h2>
      <p>You have learned how to:</p>
      <ul class="checklist">
        <li>Grab your local WebCam Audio/Video Stream.</li>
        <li>Get and Configure the Mediadevice supported parameters/constraints</li>
        <li>Discover MediaDevices, specify Input/Output Mediadevice</li>
        <li>Record localy a MediaStream using MediaRecorder API</li>
        <li>Setup PeerConnection and howto follow it's states</li>
        <li>Use DataChannel</li>
        <li>Use a simple (socket.io based) Signaling Channel</li>
        <li>Install KnockPlop</li>
      </ul>
      <h2>Learn more about related API-s</h2>
      <p>GetUserMedia API</p>
      <ul>
        <li>
          W3C: <a href="https://www.w3.org/TR/mediacapture-streams/" target="_blank">https://www.w3.org/TR/mediacapture-streams/</a>
        </li>
        <li>
          Mozilla Developers: <a href="https://developer.mozilla.org/en-US/docs/Web/API/MediaDevices/getUserMedia" target="_blank">developer.mozilla.org/en-US/docs/Web/API/MediaDevices/getUserMedia</a>
        </li>
      </ul>
      <p>WebRTC API</p>
      <ul>
        <li>
          W3C: <a href="https://www.w3.org/TR/webrtc/" target="_blank">www.w3.org/TR/webrtc/</a>
        </li>
        <li>
          Mozilla Developers: <a href="https://developer.mozilla.org/en-US/docs/Web/API/RTCPeerConnection" target="_blank">developer.mozilla.org/en-US/docs/Web/API/RTCPeerConnection</a>
        </li>
      </ul>
      <p>WebAudio API</p>
      <ul>
        <li>
          W3C: <a href="https://www.w3.org/TR/webaudio/" target="_blank">www.w3.org/TR/webaudio/</a>
        </li>
        <li>
          Mozilla Developers: <a href="https://developer.mozilla.org/en-US/docs/Web/API/Web_Audio_API" target="_blank">developer.mozilla.org/en-US/docs/Web/API/Web_Audio_API</a>
        </li>
      </ul>
      <p>MediaStream Recorder API</p>
      <ul>
        <li>
          W3C: <a href="https://www.w3.org/TR/mediastream-recording/" target="_blank">www.w3.org/TR/mediastream-recording/</a>
        </li>
        <li>
          Mozilla Developers: <a href="https://developer.mozilla.org/en-US/docs/Web/API/MediaRecorder/MediaRecorder" target="_blank">developer.mozilla.org/en-US/docs/Web/API/MediaRecorder/MediaRecorder</a>
        </li>
      </ul>
      <p>Media Capture from DOM Elements API</p>
      <ul>
        <li>
          W3C: <a href="https://www.w3.org/TR/mediacapture-fromelement/" target="_blank">www.w3.org/TR/mediacapture-fromelement/</a>
        </li>
        <li>
          Mozilla Developers: <a href="https://developer.mozilla.org/en-US/docs/Web/API/CanvasCaptureMediaStream" target="_blank">developer.mozilla.org/en-US/docs/Web/API/CanvasCaptureMediaStream</a>
        </li>
      </ul>
      <p>Audio Output Devices API</p>
      <ul>
        <li>
          W3C: <a href="https://www.w3.org/TR/audio-output/" target="_blank">www.w3.org/TR/audio-output/</a>
        </li>
     </ul>
    </google-codelab-step>
<!-- ================================ Step ========================================= -->
  </google-codelab>

</body>
</html>
